# Settings to manage and configure a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

runtime: nodejs20
runConfig:
  # Increase this value if you'd like to automatically spin up
  # more instances in response to increased traffic.
  maxInstances: 1

# Serve static assets from the .next/static directory
hosting:
  public: .next/static
  rewrites:
    - source: /**
      server:
        id: next-server

# Your Next.js app runs on a server
backend:
  id: next-server
  run: npm start
  env:
    NODE_ENV: production

# Set security headers
headers:
  - source: /**
    headers:
      - key: Strict-Transport-Security
        value: max-age=31536000; includeSubDomains; preload
      - key: X-Content-Type-Options
        value: nosniff
      - key: X-Frame-Options
        value: SAMEORIGIN
      - key: X-XSS-Protection
        value: 1; mode=block
      - key: Referrer-Policy
        value: strict-origin-when-cross-origin
      - key: Content-Security-Policy
        value: >
          default-src 'self';
          script-src 'self' https://apis.google.com https://www.googletagmanager.com;
          style-src 'self' 'unsafe-inline';
          img-src 'self' data: https://www.google-analytics.com;
          connect-src 'self' https://www.google-analytics.com https://firestore.googleapis.com;
          frame-src 'self' https://accounts.google.com;
